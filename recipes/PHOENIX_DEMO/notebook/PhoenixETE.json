{"paragraphs":[{"text":"%jdbc(phoenix)\n\nDROP TABLE EAGLEAUM101","user":"admin","dateUpdated":"2017-11-13T22:17:38+0000","config":{"editorMode":"ace/mode/sql","colWidth":12,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446991_2019328132","id":"20170925-005745_533219157","dateCreated":"2017-11-13T22:00:46+0000","dateStarted":"2017-11-13T22:17:38+0000","dateFinished":"2017-11-13T22:17:59+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1014"},{"text":"%jdbc(phoenix)\n\nCREATE TABLE IF NOT EXISTS EAGLEAUM101 (\nACCOUNT_NAME VARCHAR(100),\nEFFECTIVE_DATE DATE NOT NULL,\nTENANT_ID INTEGER NOT NULL,\nACCOUNT_CODE VARCHAR(100),\nPOSITION_DETAIL_ID BIGINT,\nACCOUNT_SUBTYPE VARCHAR(100),\nACCOUNT_TYPE VARCHAR(100),\nASSET_CLASS_LEVEL_1 VARCHAR(100),\nASSET_CLASS_LEVEL_2 VARCHAR(100),\nASSET_CLASS_LEVEL_3 VARCHAR(100),\nBASE_CURRENCY VARCHAR(100),\nCLIENT_SUB_TYPE VARCHAR(100),\nCLIENT_TYPE VARCHAR(100),\nCURRENCY_STRATEGY VARCHAR(100),\nINVESTMENT_TYPE VARCHAR(100),\nLEAD_INVESTMENT_MGR VARCHAR(100),\nMANDATE_TYPE VARCHAR(100),\nMARKET_VALUE DOUBLE,\nPORTFOLIO_PM_NAME VARCHAR(100),\nPROCESS_SEC_TYPE VARCHAR(100),\nPRODUCT_CODE VARCHAR(100),\nSECURITY_ALIAS INTEGER NOT NULL,\nSECURITY_CODE VARCHAR(100),\nSECURITY_NAME VARCHAR(100),\nSRC_INTFC_INST INTEGER, \nCONSTRAINT PK_EAGLEAUM10 PRIMARY KEY (ACCOUNT_NAME, EFFECTIVE_DATE, TENANT_ID, SECURITY_ALIAS)) \nSALT_BUCKETS = 40;","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorMode":"ace/mode/sql","colWidth":12,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446994_2030485850","id":"20170922-224118_171789405","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1015"},{"text":"%spark.dep\n\nz.load(\"com.databricks:spark-csv_2.10:1.5.0\")\nz.load(\"/usr/hdp/current/phoenix-client/phoenix-client.jar\")","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446995_2030101101","id":"20170924-045740_1699620605","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1016"},{"text":"%spark\n\nvar df = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"false\").option(\"inferSchema\", \"false\").load(\"/tmp/aum.csv\")\nval newNames = Seq(\"ACCOUNT_NAME\",\"EFFECTIVE_DATE\",\"TENANT_ID\",\"ACCOUNT_CODE\",\"POSITION_DETAIL_ID\",\"ACCOUNT_SUBTYPE\",\"ACCOUNT_TYPE\",\"ASSET_CLASS_LEVEL_1\",\"ASSET_CLASS_LEVEL_2\",\"ASSET_CLASS_LEVEL_3\",\"BASE_CURRENCY\",\"CLIENT_SUB_TYPE\",\"CLIENT_TYPE\",\"CURRENCY_STRATEGY\",\"INVESTMENT_TYPE\",\"LEAD_INVESTMENT_MGR\",\"MANDATE_TYPE\",\"MARKET_VALUE\",\"PORTFOLIO_PM_NAME\",\"PROCESS_SEC_TYPE\",\"PRODUCT_CODE\",\"SECURITY_ALIAS\",\"SECURITY_CODE\",\"SECURITY_NAME\",\"SRC_INTFC_INST\")\ndf = df.toDF(newNames: _*)\ndf.printSchema\n//df.withColumn(\"EFFECTIVE_DATE\", date_format(df2(\"start_datetime_inclusive\"),\"yyyy-MM-dd HH:mm:ss\").cast(\"timestamp\"))\ndf = df.withColumn(\"TENANT_ID\", df(\"TENANT_ID\").cast(\"Integer\"))\ndf = df.withColumn(\"POSITION_DETAIL_ID\", df(\"POSITION_DETAIL_ID\").cast(\"Long\"))\ndf = df.withColumn(\"MARKET_VALUE\", df(\"MARKET_VALUE\").cast(\"Double\"))\ndf = df.withColumn(\"SECURITY_ALIAS\", df(\"SECURITY_ALIAS\").cast(\"Integer\"))\ndf = df.withColumn(\"SRC_INTFC_INST\", df(\"SRC_INTFC_INST\").cast(\"Integer\"))\ndf.printSchema\ndf.show\ndf.cache","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446996_2028177356","id":"20170922-224146_816469800","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1017"},{"text":"%spark\n\nimport java.net.InetAddres\nimport org.apache.phoenix.spark._\nimport org.apache.spark.sql.SaveMode\n\nval zkConnectString = InetAddress.getLocalHost().getHostName()+\":2181:/hbase-unsecure\"\ndf.write.format(\"org.apache.phoenix.spark\").mode(SaveMode.Overwrite).options(Map(\"table\" -> \"EAGLEAUM101\",\"zkUrl\" -> zkConnectString)).save","dateUpdated":"2017-11-13T22:17:19+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","colWidth":12,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446997_2027792608","id":"20170922-230147_1131686471","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1018"},{"text":"%jdbc(phoenix)\n\nSELECT *\nFROM eagleaum101 \n","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorMode":"ace/mode/sql","colWidth":12,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446997_2027792608","id":"20170927-135342_1907962500","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1019"},{"text":"%jdbc(phoenix)\n\nSELECT count(account_name) \nFROM eagleaum101 \n\n","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorMode":"ace/mode/sql","colWidth":12,"results":{"0":{"graph":{"optionOpen":false,"mode":"table","height":94}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446998_2028946854","id":"20170927-134116_1604823232","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1020"},{"text":"%jdbc(phoenix)\n\nselect * \nfrom eagleaum101 \nwhere effective_date = TO_DATE('2016-03-03 00:00:00.000')\nand tenant_id in (50)\nand security_alias = 2\nand account_name = 'CraigAccount_10010732'","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorMode":"ace/mode/sql","colWidth":12,"results":{"0":{"graph":{"optionOpen":false,"mode":"table","height":84}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446998_2028946854","id":"20170924-064501_586535007","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1021"},{"text":"%jdbc(phoenix)\n\nSELECT count(account_name), effective_date\n--SELECT /*+SKIP_SCAN*/ count(account_name), effective_date\nFROM eagleaum101 \nWHERE effective_date between TO_DATE('2016-03-03 00:00:00.000') and TO_DATE('2017-12-30 00:00:00.000')\nAND tenant_id in (50)\nAND security_alias = 2\nGROUP BY effective_date","dateUpdated":"2017-11-13T22:00:46+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"editorMode":"ace/mode/sql","colWidth":12,"results":{"0":{"graph":{"keys":[{"index":1,"name":"EFFECTIVE_DATE","aggr":"sum"}],"optionOpen":false,"height":300,"setting":{"pieChart":{}},"values":[{"index":0,"name":"COUNT(ACCOUNT_NAME)","aggr":"sum"}],"mode":"pieChart","groups":[{"index":1,"name":"EFFECTIVE_DATE","aggr":"sum"}],"commonSetting":{}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446999_2028562105","id":"20170923-001525_376428876","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1022"},{"text":"%jdbc(phoenix)\n\nSELECT ACCOUNT_CODE, ACCOUNT_NAME AS label,\nSUM(CASE WHEN (ASSET_CLASS_LEVEL_2 = 'Option' OR ASSET_CLASS_LEVEL_2 = 'Option2') AND (ASSET_CLASS_LEVEL_3 = 'Security' OR ASSET_CLASS_LEVEL_3 = 'Security2' OR ASSET_CLASS_LEVEL_3 = 'Security3') THEN (MARKET_VALUE / 300) ELSE 0 END) AS AUM,\nSUM(MARKET_VALUE)\nFROM eagleaum101\nWHERE EFFECTIVE_DATE = TO_DATE('2016-03-03 00:00:00.000')  AND ACCOUNT_NAME IN ('CraigAccount_100000', 'CraigAccount_10000004', 'CraigAccount_10000027', 'CraigAccount_10000005', 'CraigAccount_10000001') \nGROUP BY ACCOUNT_CODE, ACCOUNT_NAME\nORDER BY AUM ASC","dateUpdated":"2017-11-13T22:00:46+0000","config":{"editorMode":"ace/mode/sql","colWidth":12,"results":{"0":{"graph":{"keys":[{"index":0,"name":"ACCOUNT_CODE","aggr":"sum"}],"optionOpen":false,"height":300,"setting":{"pieChart":{}},"values":[{"index":3,"name":"SUM(MARKET_VALUE)","aggr":"sum"},{"index":2,"name":"AUM","aggr":"sum"}],"mode":"pieChart","groups":[{"index":0,"name":"ACCOUNT_CODE","aggr":"sum"},{"index":1,"name":"LABEL","aggr":"sum"}],"commonSetting":{}},"helium":{}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446999_2028562105","id":"20170924-062615_225136849","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1023"},{"dateUpdated":"2017-11-13T22:00:47+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510610446999_2028562105","id":"20170926-211830_1797791469","dateCreated":"2017-11-13T22:00:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1024"}],"name":"PhoenixETE","id":"2D1V22Y6F","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
